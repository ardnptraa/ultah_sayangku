<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Happy Birthday My Love â¤ï¸</title>

<style>
/* ================= RESET ================= */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

/* ================= BODY ================= */
body {
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #ff9a9e, #fad0c4);
    color: #26453d;
    text-align: center;
    overflow-x: hidden;
}

/* ================= SECTION ================= */
section {
    min-height: 100vh;
    padding: 20px;
    display: none;
    justify-content: center;
    align-items: center;
    flex-direction: column;
}

section.active {
    display: flex;
}

/* ================= TEXT ================= */
h1, h2, h3, h4 {
    margin: 6px 0;
}

p {
    max-width: 500px;
    margin: 10px auto;
}

/* ================= FORM ================= */
input, textarea {
    width: 260px;
    padding: 10px;
    margin: 6px 0;
    border-radius: 10px;
    border: none;
}

/* ================= BUTTON ================= */
.btn {
    background: #26453d;
    color: white;
    border: none;
    padding: 12px 26px;
    border-radius: 25px;
    cursor: pointer;
    margin: 8px;
}

.btn:hover {
    background: #e73370;
}

/* ================= IMAGE ================= */
img {
    width: 200px;
    border-radius: 20px;
    margin: 15px 0;
}

/* ================= GRID GAME ================= */
.grid {
    display: grid;
    grid-template-columns: repeat(5, 60px);
    gap: 15px;
}

.box {
    width: 60px;
    height: 60px;
    background: white;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    cursor: pointer;
}

/* ================= GALLERY ================= */
.gallery {
    display: none;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 15px;
    margin-top: 20px;
    max-width: 700px;
}

.gallery img {
    width: 100%;
    height: 180px;
    object-fit: cover;
    border-radius: 15px;
}

/* ================= PROGRESS ================= */
.progress-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 6px;
    background: rgba(255,255,255,.3);
}

.progress {
    height: 100%;
    width: 0%;
    background: #26453d;
    transition: .3s;
}

/* ===== IMAGE MODAL ===== */
.modal {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.8);
    z-index: 999;
    justify-content: center;
    align-items: center;
}

.modal img {
    max-width: 90%;
    max-height: 90%;
    border-radius: 20px;
}

.modal .close {
    position: absolute;
    top: 20px;
    right: 30px;
    font-size: 35px;
    color: white;
    cursor: pointer;
}

body.night {
  background: linear-gradient(135deg,#1a1a2e,#16213e);
  color: #ffd6dc;
}

body.night .btn {
  background:#ffd6dc;
  color:#1a1a2e;
}

#romanticCountdown {
  margin-top:10px;
  font-weight:bold;
  color:#e73370;
}

#proposal {
    background: linear-gradient(135deg, #1a1a2e, #16213e);
    color: #ffd6dc;
}

#proposal h1 {
    font-size: 22px;
    max-width: 500px;
    line-height: 1.6;
    animation: fadeIn 1.5s;
}


/* ================= CONFETTI ================= */
.confetti {
    position: fixed;
    top: -10px;
    font-size: 22px;
    animation: fall 4s linear forwards;
}

.freeze * {
    animation-play-state: paused !important;
}

@keyframes fall {
    to {
        transform: translateY(110vh) rotate(360deg);
        opacity: 0;
    }
}
</style>
</head>

<body>

<audio id="bgMusic" loop>
    <source src="Lagu-ultah.mp3" type="audio/mpeg">
</audio>

<div class="progress-container">
    <div class="progress" id="progress"></div>
</div>

<!-- ================= LOGIN ================= -->
<section id="login" class="active">
    <h1>MASUK DULU YA CANTIK ğŸ’–</h1>
    <p>Jangan lupa play music dulu biar tambah rasanya</p>
    <input id="name" placeholder="Nama lengkap">
    <input id="password" type="password" placeholder="Password">
    <button class="btn" onclick="playMusic()">ğŸµ PLAY MUSIC</button>
    <button class="btn" onclick="checkLogin()">Masuk</button>
</section>

<!-- ================= GAME 1 ================= -->
<section id="game1">
    <h3>Game 1 ğŸ’•</h3>
    <p>Kapan tanggal jadian kita?</p>
    <input id="answerGame1" placeholder="contoh: 17 Agustus 1945">
    <button class="btn" onclick="checkGame1()">Jawab</button>
</section>

<!-- ================= GAME 2 ================= -->
<section id="game2">
    <h3>Game 2 ğŸ’•</h3>
    <p>Makanan hero ML anime favorit mas?</p>
    <p>(sesuai contoh)</p>
    <input id="answerGame2" placeholder="contoh: Bakso Lancelot Bleach">
    <button class="btn" onclick="checkGame2()">Jawab</button>
</section>

<!-- ================= GAME 3 ================= -->
<section id="game3">
    <h3>Mini Game ğŸ’£</h3>
    <p>Buka 8 kotak aman (2 bom)</p>
    <div class="grid" id="grid"></div>
</section>

<!-- ================= MAIN ================= -->
<section id="main">
    <h1>MARATUL INAYAH ğŸ‚</h1>
    <h2>TWENTIES</h2>
    <p>Selamat ulang tahun yang ke 23 tahun, sayangku</p>
    <p>26 Desember 2025</p>
    <img src="1.png" alt="Foto Cantik">
    <p id="mainText">Hari ini spesial untukmu ğŸ¤</p>

<!-- ===== NIGHT MODE ===== -->
<button class="btn" onclick="toggleNight()">NIGHT MODE ğŸŒ™</button>

<!-- ===== LOVE PROGRESS ===== -->
<h3>Cinta Mas ke Adek â¤ï¸</h3>
<div style="width:260px;height:14px;background:#ffd6dc;border-radius:20px;">
  <div id="loveBar" style="height:100%;width:0%;background:#e73370;border-radius:20px;"></div>
</div>

<!-- ===== SECRET LETTER ===== -->
<button class="btn" id="letterBtn" disabled onclick="openLetter()">BUKA SURAT RAHASIA ğŸ’Œ</button>
<p id="letterText" style="display:none;max-width:500px;">
  Adek adalah rumah paling tenang yang pernah mas temukan.  
  Terima kasih sudah bertahan, tertawa, dan tumbuh bersama mas ğŸ¤
</p>

<!-- ===== VOICE MESSAGE ===== -->
<button class="btn" onclick="playVoice()">DENGAR SUARA MAS ğŸ™ï¸</button>

<!-- ===== TIMELINE CINTA ===== -->
<button class="btn" onclick="toggleTimeline()">TIMELINE KITA ğŸ“–</button>
<div id="timeline" style="display:none;max-width:500px;">
  <p>ğŸ“± Pertama Chat â€” Deg-degan</p>
  <p>â˜• First Date â€” Dunia terasa kadang pelan dan kadang cepat</p>
  <p>ğŸŒ§ï¸ Bertengkar â€” Tapi memilih bertahan</p>
  <p>â¤ï¸ Hari Ini â€” Mas masih jatuh cinta</p>
</div>

<!-- ===== QUIZ EMOSIONAL ===== -->
<button class="btn" onclick="openEmotionQuiz()">IT'S FACT ğŸ’­</button>
<p id="emotionQuiz" style="display:none;">
  Hal apa yang paling mas takuti?<br>
  <b>Ketika mas engga bisa buat ade nyaman dan bahagia</b>
</p>

<!-- ===== COUNTDOWN ===== -->
<button class="btn" onclick="startRomanticCountdown()">COUNTDOWN ğŸ’</button>
<p id="romanticCountdown"></p>

<!-- ===== SURPRISE KATA-KATA ===== -->
<button class="btn" onclick="showSurprise()">SURPRISE ğŸ</button>
<p id="surpriseText" style="display:none;">Mas sayang adek hari ini, besok, dan selamanya ğŸ’–</p>
    
<!-- ===== COPY LINK ===== -->
<button class="btn" onclick="startCountdown()">CLICK AND COPY THE LINK â³</button>
<p id="countdownText" style="display:none;"></p>

<!-- ===== GALLERY ===== -->
<button class="btn" onclick="toggleGallery()">GALLERY ğŸ“¸</button>
<div class="gallery" id="gallery">
    <img src="2.png" alt="Foto ade" onclick="openModal(this)">
    <img src="3.png" alt="Foto ade" onclick="openModal(this)">
    <img src="4.png" alt="Foto ade" onclick="openModal(this)">
    <img src="5.png" alt="Foto ade" onclick="openModal(this)">
    <img src="6.png" alt="Foto ade" onclick="openModal(this)">
    <img src="7.png" alt="Foto ade" onclick="openModal(this)">
    <img src="8.png" alt="Foto ade" onclick="openModal(this)">
</div>

<!-- ===== MOVE PESAN ===== -->
    <button class="btn" onclick="openSection('message')">KIRIM PESAN ğŸ’Œ</button>
</section>

<!-- ================= MESSAGE ================= -->
<section id="message">
    <h1>Pesan untuk mas ğŸ’–</h1>
    <textarea id="waMessage" rows="5"></textarea>
    <button class="btn" onclick="sendToWA()">Kirim ke WhatsApp</button>
    
<!-- ===== FINAL ENDING ===== -->
<button class="btn" onclick="finalScene()">FINAL SURPRISE ğŸ‚</button>
<button class="btn" onclick="startProposal()">FINAL SURPRISE ğŸ’</button>
</section>

<!-- ===== PROPOSAL SCENE ===== -->
<section id="proposal">
    <h1 id="proposalText"></h1>
    <div id="proposalBtns" style="display:none;">
        <button class="btn" onclick="acceptProposal()">ğŸ’– Iya, aku mau</button>
        <button class="btn" onclick="needHug()">ğŸ˜³ Aku butuh pelukan dulu</button>
    </div>
</section>

<script>

/* ================= GLOBAL ================= */
let progress = 0;
let bombs = [];
let opened = 0;

/* ================= UTIL ================= */
function openSection(id) {
    document.querySelectorAll("section").forEach(s => s.classList.remove("active"));
    document.getElementById(id).classList.add("active");
}

function updateProgress() {
    progress = Math.min(progress + 25, 100);
    document.getElementById("progress").style.width = progress + "%";
}

function setMusic(src) {
    const m = document.getElementById("bgMusic");
    m.src = src;
    m.play();
}

/* ================= LOGIN ================= */
function playMusic() {
    const audio = document.getElementById("bgMusic");
    audio.volume = 1.0;
    audio.play()
        .then(() => {
            console.log("ğŸµ Musik berjalan");
        })
        .catch(err => {
            alert("Browser menolak audio ğŸ˜­\nCoba klik sekali lagi");
            console.error(err);
        });
}

function checkLogin() {
    const name = document.getElementById("name").value.trim();
    const pass = document.getElementById("password").value.trim();
    if (!name || pass !== "0") {
        alert("Nama atau password salah ğŸ˜œ");
        return;
    }
    localStorage.setItem("playerName", name);
    openSection("game1");
}

const nameInput = () => document.getElementById("name").value.trim();
const passwordInput = () => document.getElementById("password").value.trim();

/* ================= GAME 1 ================= */
function checkGame1() {
    const ans = answer("answerGame1");
    if (!ans) return alert("Jawab dulu ğŸ˜†");
    if (ans.includes("15") && ans.includes("Oktober") && ans.includes("2022")) {
        updateProgress();
        openSection("game2");
    } else alert("Masih salah ğŸ˜");
}

/* ================= GAME 2 ================= */
function checkGame2() {
    const ans = answer("answerGame2");
    if (!ans) return alert("Jawab dulu ğŸ˜†");

    if (ans.includes("Mie Ayam") && ans.includes("Yi Sun-Shin") && ans.includes("Naruto")) {
        updateProgress();
        openSection("game3");
        initGame();
    } else alert("Masih salah ğŸ˜");
}

const answer = id =>
    document.getElementById(id).value.trim();

/* ================= GAME 3 ================= */
function initGame() {
    bombs = [];
    opened = 0;
    const grid = document.getElementById("grid");
    grid.innerHTML = "";

    while (bombs.length < 0) {
        const r = Math.floor(Math.random() * 10);
        if (!bombs.includes(r)) bombs.push(r);
    }

    for (let i = 0; i < 10; i++) {
        const box = document.createElement("div");
        box.className = "box";
        box.textContent = "?";
        box.onclick = () => openBox(i, box);
        grid.appendChild(box);
    }
}

function openBox(i, box) {
    if (bombs.includes(i)) {
        alert("BOOM ğŸ’¥ Kirim pap ğŸ˜œ");
        initGame();
        return;
    }
    box.textContent = "â¤ï¸";
    box.style.pointerEvents = "none";
    opened++;
    if (opened === 8) {
        updateProgress();
        confetti();
        openSection("main");
    }
}

/* ================= MAIN ================= */
function showSurprise() {
    document.getElementById("surpriseText").style.display = "block";
    document.getElementById("mainText").textContent =
        "Hari ini milikmu, dan hatiku juga ğŸ’•";
}

function startCountdown() {
    let timeLeft = 300; // â³ ganti sesuai mau (detik)
    const el = document.getElementById("countdownText");
    el.style.display = "block";

    el.textContent = `Surprise dalam ${timeLeft}...`;

    const timer = setInterval(() => {
        timeLeft--;
        el.textContent = `Surprise dalam ${timeLeft}...`;

        if (timeLeft <= 0) {
            clearInterval(timer);
            el.textContent = "ğŸ‰ Surprise-nya sudah dekat, baca chat mas ya ğŸ’–";
            confetti(); // optional: langsung confetti
        }
    }, 1000);
}


function toggleGallery() {
    const g = document.getElementById("gallery");
    g.style.display = g.style.display === "grid" ? "none" : "grid";
}

/* ===== GLOBAL LOVE ===== */
let love = 0;

/* ===== LOVE BAR ===== */
function addLove() {
  love = Math.min(love + 20, 100);
  document.getElementById("loveBar").style.width = love + "%";
  if (love >= 100) {
    document.getElementById("letterBtn").disabled = false;
  }
}

/* ===== VOICE ===== */
function playVoice() {
  const voice = new Audio("voice-mas.mp3");
  voice.play();
  addLove();
}

/* ===== LETTER ===== */
function openLetter() {
  document.getElementById("letterText").style.display = "block";
}

/* ===== TIMELINE ===== */
function toggleTimeline() {
  const t = document.getElementById("timeline");
  t.style.display = t.style.display === "block" ? "none" : "block";
  addLove();
}

/* ===== QUIZ ===== */
function openEmotionQuiz() {
  document.getElementById("emotionQuiz").style.display = "block";
  addLove();
}

/* ===== COUNTDOWN ===== */
function startRomanticCountdown() {
  let t = 7;
  const el = document.getElementById("romanticCountdown");
  el.innerText = `Mas mencintaimu dalam ${t}...`;
  const timer = setInterval(()=>{
    t--;
    el.innerText = `Mas mencintaimu dalam ${t}...`;
    if(t<=0){
      clearInterval(timer);
      el.innerText = "Dan akan terus begitu ğŸ’–";
      confetti();
      addLove();
    }
  },1000);
}

/* ===== NIGHT MODE ===== */
function toggleNight() {
  document.body.classList.toggle("night");
}

/* ===== FINAL SCENE ===== */
function finalScene() {
  document.body.innerHTML = `
    <div style="min-height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center;">
      <h1>Terima kasih sudah lahir ğŸ¤</h1>
      <p>Kamu adalah keputusan terbaik mas.</p>
    </div>
  `;
  confetti();
}

/* ================= CONFETTI ================= */
function confetti() {
    for (let i = 0; i < 40; i++) {
        const c = document.createElement("div");
        c.className = "confetti";
        c.textContent = "ğŸ‰";
        c.style.left = Math.random() * 100 + "vw";
        c.style.animationDuration = "4s";
        document.body.appendChild(c);
    }
}

/* ================= WA ================= */
function sendToWA() {
    const msg = document.getElementById("waMessage").value.trim();
    if (!msg) return alert("Pesan kosong ğŸ˜˜");

    const name = localStorage.getItem("playerName") || "Sayang";
    const phone = "6285606186250";
    window.open(
        `https://wa.me/${phone}?text=${encodeURIComponent(`Dari ${name}\n\n${msg}`)}`,
        "_blank", "noopener"
    );
}

function startProposal() {
    openSection("proposal");

    const text = [
        "Adekâ€¦",
        "Mas nggak janji hidup yang sempurna.",
        "Tapi mas janji hadir,",
        "setiap kamu lelah,",
        "setiap kamu ragu,",
        "dan setiap kamu butuh pulang.",
        "",
        "Maukah kamuâ€¦",
        "menjadi rumah mas selamanya?"
    ];

    let i = 0;
    const el = document.getElementById("proposalText");
    el.innerHTML = "";

    const typing = setInterval(() => {
        el.innerHTML += text[i] + "<br>";
        i++;
        if (i === text.length) {
            clearInterval(typing);
            document.getElementById("proposalBtns").style.display = "block";
            confetti();
        }
    }, 900);
}

function acceptProposal() {
    if (sessionStorage.getItem("proposalDone")) return;
    sessionStorage.setItem("proposalDone", "yes");

    // 1. Freeze confetti
    document.body.classList.add("freeze");

    // 2. Sembunyikan tombol
    document.getElementById("proposalBtns").style.display = "none";

    // 3. Confetti jatuh
    confetti();

    // 4. Screenshot momen
    setTimeout(() => {
        takeScreenshot();
    }, 800);
    
    const message = `
Nduk mau
Nduk nggak tahu bagaimana menjelaskan rasanyaâ€¦
tapi nduk yakin satu hal.

Nduk mau berjalan bareng mas,
jatuh, bangun, dan tumbuh bersama.

Nduk bilang iya`;

    const phoneNumber = "6285606186250"; // GANTI nomor kamu
    const waUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;

    document.getElementById("proposalText").innerHTML =
        "ğŸ’ Terima kasih sudah bilang iya ğŸ¤<br>Mas tunggu jawabanmu di WhatsAppâ€¦";

    document.getElementById("proposalBtns").style.display = "none";
    confetti();

    setTimeout(() => {
        window.open(waUrl, "_blank", "noopener");
    }, 4000);
}

function needHug() {
    alert("Mas di sini ğŸ¤ Peluk virtual dulu yaâ€¦");
}

function takeScreenshot() {
    const body = document.body;

    html2canvas(body).then(canvas => {
        const link = document.createElement("a");
        link.download = "lamaran-kita.png";
        link.href = canvas.toDataURL("image/png");
        link.click();
    });
}

function openModal(img) {
    document.getElementById("imgModal").style.display = "flex";
    document.getElementById("modalImg").src = img.src;
}

function closeModal() {
    document.getElementById("imgModal").style.display = "none";
}

</script>

<!-- MODAL ZOOM -->
<div id="imgModal" class="modal">
    <span class="close" onclick="closeModal()">Ã—</span>
    <img id="modalImg">
</div>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</body>
</html>
